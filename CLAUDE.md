<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 31, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #88 | 2:37 PM | ‚öñÔ∏è | Designed comprehensive implementation plan for Habits Phase 2 with streak tracking and UI management | ~523 |
| #78 | 2:02 PM | üü£ | Added getTodaySkipDay function for current day skip status | ~297 |
| #25 | 8:36 AM | üü£ | Implemented automated morning email briefing with Resend | ~434 |
</claude-mem-context>

---

# JeanToDoList ‚Äî Claude Project Guidelines

## Project Overview
Personal task management app for Jean (Janot). Live at `tasks.jeanmarcotte.com`. Built with Next.js + Supabase + Vercel.

## Current Tabs
- **Tasks** ‚Äî Standard todo items with completion celebration at 50
- **Buy** ‚Äî Shopping/purchase list (added Feb 4, 2026)
- **Stakes** ‚Äî High-stakes items
- **Habits** ‚Äî Daily habits with streak tracking (Phase 2 designed Jan 31)

---

## Feature: Priorities Tab (Spec'd Feb 5, 2026 ‚Äî NOT YET BUILT)

### Purpose
"What matters RIGHT NOW." Urgent, fluid, reorderable. Today's battles.

### UI Layout Change
```
[Priorities (count)] [Goals (count)]     ‚Üê NEW ROW
[Active (count)]     [Complete (count)]  ‚Üê EXISTING ROW
[Tasks] [Buy] [Stakes] [Habits]          ‚Üê EXISTING TABS
```
- Remove Toronto time display on mobile only (keep on desktop if desired)
- New buttons same size/style as Active/Complete row
- Small spacing gap between new row and Active/Complete row
- Badge counts on both new buttons

### Behavior
| Aspect | Detail |
|--------|--------|
| Add | Same input style as Tasks (title only) |
| Persistence | Stay until handled ‚Äî no daily reset |
| Complete | Removes the item. No celebration, no count. |
| Dismiss | "Not relevant" button ‚Äî removes without completing |
| Reorder | Sortable on review page (drag or up/down buttons) |
| Move to bottom | Quick-demote button per item |
| Badge | Count of active priorities shown on button |

### Real-World Example
"Today I need to pack for Saturday's wedding. That's Priority #1. But at 6:15pm, my Zoom sales appointments jump to #1 and packing drops. After Zoom, packing comes back up if not done."

### Supabase Table: `priorities`
```sql
CREATE TABLE priorities (
  id BIGSERIAL PRIMARY KEY,
  title TEXT NOT NULL,
  sort_order INTEGER NOT NULL DEFAULT 0,
  status TEXT NOT NULL DEFAULT 'active' CHECK (status IN ('active', 'completed', 'dismissed')),
  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  completed_at TIMESTAMPTZ
);

-- Index for active priorities sorted by order
CREATE INDEX idx_priorities_active ON priorities (status, sort_order) WHERE status = 'active';
```

### Server Action: `actions/priorities.ts`
```typescript
"use server";

export interface Priority {
  id: number;
  title: string;
  sort_order: number;
  status: 'active' | 'completed' | 'dismissed';
  created_at: string;
  completed_at: string | null;
}

// Functions needed:
export async function getPriorities(): Promise<Priority[]> { }
export async function addPriority(title: string): Promise<Priority> { }
export async function completePriority(id: number): Promise<void> { }
export async function dismissPriority(id: number): Promise<void> { }
export async function reorderPriorities(orderedIds: number[]): Promise<void> { }
export async function moveToBottom(id: number): Promise<void> { }
export async function getActivePriorityCount(): Promise<number> { }
```

### Component: `app/components/PrioritiesTab.tsx`
- List of active priorities in sort order
- Each item has:
  - ‚úÖ Complete button (removes, no celebration)
  - ‚¨áÔ∏è Move to bottom button
  - ‚ùå Not relevant / dismiss button
- Add input at top (same pattern as Tasks)
- Reorder capability on review page

---

## Feature: Goals Tab (Spec'd Feb 5, 2026 ‚Äî NOT YET BUILT)

### Purpose
Realistic, deadline-driven targets. Not a dream board. "Get jeanmarcotte.com its first customer" energy.

### Behavior
| Aspect | Detail |
|--------|--------|
| Add | Title + target date (both required) |
| Quantity | 5-10 at a time (realistic) |
| Complete | **Celebration moment**, then removed |
| Heat system | Visual urgency as deadline approaches |
| Badge | Count of active goals shown on button |

### Heat System
| State | Condition | Visual |
|-------|-----------|--------|
| üü¢ Cool | 30+ days to deadline | Default/green color |
| üü° Warm | ‚â§ 30 days to deadline | Yellow/amber color shift |
| üü† Hot | ‚â§ 7 days to deadline | Orange color + subtle pulse animation |
| üî¥ Overdue | Past deadline | Red color + stronger pulse animation |

### Heat Calculation
```typescript
function getHeatLevel(targetDate: string): 'cool' | 'warm' | 'hot' | 'overdue' {
  const now = new Date();
  const target = new Date(targetDate);
  const daysRemaining = Math.ceil((target.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));

  if (daysRemaining < 0) return 'overdue';
  if (daysRemaining <= 7) return 'hot';
  if (daysRemaining <= 30) return 'warm';
  return 'cool';
}
```

### Supabase Table: `goals`
```sql
CREATE TABLE goals (
  id BIGSERIAL PRIMARY KEY,
  title TEXT NOT NULL,
  target_date DATE NOT NULL,
  status TEXT NOT NULL DEFAULT 'active' CHECK (status IN ('active', 'completed')),
  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  completed_at TIMESTAMPTZ
);

-- Index for active goals sorted by deadline
CREATE INDEX idx_goals_active ON goals (status, target_date) WHERE status = 'active';
```

### Server Action: `actions/goals.ts`
```typescript
"use server";

export interface Goal {
  id: number;
  title: string;
  target_date: string;
  status: 'active' | 'completed';
  created_at: string;
  completed_at: string | null;
}

// Functions needed:
export async function getGoals(): Promise<Goal[]> { }
export async function addGoal(title: string, targetDate: string): Promise<Goal> { }
export async function completeGoal(id: number): Promise<void> { }
export async function deleteGoal(id: number): Promise<void> { }
export async function getActiveGoalCount(): Promise<number> { }
```

### Component: `app/components/GoalsTab.tsx`
- List of active goals sorted by target date (soonest first)
- Each item shows:
  - Title
  - Target date + days remaining
  - Heat indicator (color + animation)
  - ‚úÖ Complete button (triggers celebration)
- Add input with title field + date picker
- Celebration popup on completion (similar to Tasks celebration but unique to Goals)

### Goal Celebration Component
- Different from the 50-task celebration
- Triggered on EVERY goal completion (these are big deals)
- Auto-dismiss after 5 seconds or click to close
- Message like: "üéØ GOAL ACHIEVED!" with the goal title

---

## Build Checklist (Priorities + Goals ‚Äî Next Mac Studio Session)

### Database (Supabase Dashboard)
- [ ] Create `priorities` table with SQL above
- [ ] Create `goals` table with SQL above
- [ ] Verify RLS settings (match existing tables)

### Server Actions
- [ ] Create `actions/priorities.ts`
- [ ] Create `actions/goals.ts`
- [ ] Test all functions

### Components
- [ ] Create `PrioritiesTab.tsx`
- [ ] Create `GoalsTab.tsx`
- [ ] Create `GoalCelebration.tsx`

### Main Page (`app/page.tsx`)
- [ ] Add 'priorities' and 'goals' to tab state
- [ ] Remove Toronto time on mobile (CSS media query or responsive check)
- [ ] Add new button row above Active/Complete
- [ ] Wire up badge counts
- [ ] Wire up tab switching

### Test
- [ ] Add/complete/dismiss priorities
- [ ] Reorder priorities
- [ ] Move priority to bottom
- [ ] Add goals with dates
- [ ] Verify heat colors at different day ranges
- [ ] Verify pulse animation on hot/overdue
- [ ] Complete a goal ‚Äî celebration fires
- [ ] Badge counts update correctly
- [ ] Mobile layout looks right

### Don't Forget
- [ ] Update this CLAUDE.md after building
- [ ] Push to git after building
- [ ] Deploy to Vercel and test on iPhone

---

## Session History

### Feb 4, 2026
- Added popup modal for full task text on mobile
- Custom domain `tasks.jeanmarcotte.com` configured
- Fixed date picker visibility on mobile (`colorScheme: 'dark'`)
- Added **Buy tab** (new Supabase table + BuyTab component)
- Removed broken email cron jobs
- Fixed Vercel env var (`SUPABASE_SERVICE_ROLE_KEY`)

### Jan 31, 2026
- Designed Habits Phase 2 with streak tracking and UI management
- Added getTodaySkipDay function for current day skip status
- Implemented automated morning email briefing with Resend

---
*Last Updated: February 5, 2026 ‚Äî Priorities & Goals spec added (not yet built)*
